# ПРОЕКТ: Обучение с учителем: качество модели

В роли стажера отдела цифровых технологий интернет-магазина «В один клик» разработать решение, которое позволит персонализировать предложения постоянным клиентам, чтобы увеличить их покупательскую активность.

# Задачи проекта
1. Построить модель, которая предскажет вероятность снижения покупательской активности клиента в следующие три месяца.
2. На основе данных моделирования и прибыльности клиентов выделить сегмент покупателей и разработать для него персонализированные предложения.

# Краткий обзор проведенной работы:

Главные задачи проекта это построение модели машинного обучения, которая предскажет вероятность снижения покупательской активности клиента, и разработка на основе данных моделирования и прибыльности клиентов персонализированных предложений для повышения покупательской активности для определенного сегмента покупателей.

**В качестве исходных данных имеется 4 датасета:**
- таблица, которая содержит данные о поведении покупателя на сайте, о коммуникациях с покупателем и его продуктовом поведении
- таблица с данными о выручке, которую получает магазин с покупателя, то есть сколько покупатель всего потратил за период взаимодействия с сайтом
- таблица с данными о времени (в минутах), которое покупатель провёл на сайте в течение периода
- таблица с данными о среднемесячной прибыли покупателя за последние 3 месяца: какую прибыль получает магазин от продаж каждому покупателю


**Проведена предобработка данных:**
- устранена проблема с неявными дубликатами
- нейминг столбцов приведен в соответствие принятым соглашениям (`camel_case`)
- типы данных приведены в соответствие
- устранены опечатки в значениях

Для поиска лучшей модели был применен инструмент `GridSearchCV` и перебор гиперпараметров для четырех моделей:
- `DecisionTreeClassifier()`
- `KNeighborsClassifier()`
- `LogisticRegression()`
- `SVC()`

Лучшая модель отбиралась по метрике **RECALL**. Лучшей моделью оказалась `LogisticRegression()` с `L1-регуляризацией`. Для отбора признаков был использован инструмент `SelectKBest`.

- Метрика RECALL на кросс-валидации: **0.8**
- Метрика RECALL на тестовой выборке: **0.83**
- Снижение предела отнесения наблюдения к классу 1 несет большие издержки в общей точности модели.

###  Рекомендации:

Для дополнительного исследования был взят сегмент **Группа клиентов с высокой вероятностью снижения покупательской активности и наиболее высокой прибыльностью**. Показатели признаков данной группы были проанализированы в сравнении с группой клиентов с **низкой** вероятностью снижения покупательской активности. Важность признаков изучена с помощью SHAP-значений для обученной модели. По результатам данной работы можно сформулировать следующие возможные пути повышения покупательской активности:

1. Повышать количество маркетинговых коммуникаций.
2. Напоминать о наличии неоплаченных товаров в корзине.
3. Чаще показывать карточки товара в категории **Мелкая бытовая техника и электроника**.

Для улучшения результатов анализа и повышения качества моделирования можно собирать данные с более ясной и четкой привязкой ко времени, например за каждый месяц отдельно, а так же более исчерпывающе формулировать целевую переменную (например, в какой период времени каков был уровень покупательской активности в числовом измерении).